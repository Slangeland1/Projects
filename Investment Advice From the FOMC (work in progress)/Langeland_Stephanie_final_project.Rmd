---
title: "Investment Advice from the FOMC"
author: Stephanie Langeland
date: 2017-12-15
always_allow_html: yes
output:
  html_document:
    keep_md: true
    toc: true
---

__Please note that this file contains interactive charts__
__and graphs so please download the html file rather than reviewing__
__the github .md file.__

# Abstract 

The purpose of this final project (data - A1/A2) is to fulfill the requirements for
Modern Data Structures (QMSS G5072).  The goal of this project is to obtain economic
data from the Federal Reserve System and Yahoo Finance.  This summary file explains
the theoretical motivation behind this data collection (sections 1-2 below).
Throughout this file, there are references to R script files that include web 
scraping and API R code used to obtain the data used to explore the relationship
between the target federal funds rate, volatility, and U.S. 10-year treasury yields
(section 4 below).  Parts of this code were converted to functions and compiled into
an R package (section 3 below).

# 1 Introduction 

The Federal Reserve ("FED") is the central bank of the United States.  The Federal
Open Market Committee (FOMC) is responsible for implementing monetary policy by 
adjusting the discount rate, reserve requirements, and open market operations 
(Federal Reserve Bank of Saint Louis).
The FOMC has eight regularly scheduled meetings each year to determine the 
future path of monetary policy.  The FOMC may also add meetings in times 
of economic stress or crisis.  Before 1995, the FOMC did not announce
the results (future stance of monetary policy) of each meeting.  However,
in February of 1994, the FOMC released its first statement explaining
the results of the meeting.  In February 1995, the FOMC decided that
all changes to the monetary policy stance would be announced after every meeting.
Until May 1999, the FOMC only released a statement when there was a change to 
monetary policy.  Thereafter, the FOMC began releasing a statement after every 
meeting, detailing the current and future stance of the economy and monetary policy, 
irrespective of whether a change to the current monetary policy stance was made
(Federal Reserve Bank of Dallas).  Each policy statement 
details the current conditions and expectations for the economy as well as 
the current and future path of monetary policy, e.g. 
the discount rate, open market operations, and federal funds rate.  

Specifically, the FOMC changes the target federal funds rate in conjunction with 
other adjustments to the discount rate and/or open market operations to influence 
the effective federal funds rate.  It was not until July 1995 that the FOMC statements made 
reference to a specific federal funds rate level.  However, in May 1999, the
FOMC began referring to the "target" federal funds rate to increase transparency.
Although the target rate is set by the FED, the effective federal funds rate 
is the final rate at which financial institutions lend to each other.  The 
effective federal funds rate is the rate that influences all interest rates as it
typically acts as a floor since financial institutions do not have incentives to offer
lower rates as they would incur losses.  Therefore, the effective federal funds
rate is the rate that is set by the market and influenced by the FOMC when it sets the 
target federal funds rate, discount rate, and open market operations. 

Each scheduled FOMC meeting spans two days.  Typically, the FOMC policy statement
is released on day two at 2 PM EDT.  Although the market typically factors in 
future changes to monetary policy, given the FED's commitment to transparency, 
there is a noticeable market reaction when the FOMC policy statement is released.
This study will examine how the FOMC's decision, regarding the target federal 
funds rate, affects volatility and treasury yields.  

# 2 Data & Methodology 

In order to study the relationship between FOMC policy statements,
target federal funds rate, volatility, and treasury yields,
data will be scraped from the FED's website and Yahoo Finance
using a FRED API key.

__Note:__  All data were obtained as of December 1, 2017.

## 2.1 Time Period 

Although the FED has archived and made available all FOMC meeting materials since 
1936, all data for this study will begin in 1995, which is when the 
FOMC started releasing statements at the conclusion of certain meetings.  For the FOMC
meetings from 1995 - 1999, when no change to the current monetary policy stance was made, 
thus no policy statement issued, the hypothesis is that the market should have
reacted to the absence of a statement which signaled no change to monetary policy.

## 2.2 FOMC Policy Statements

The date that the FOMC policy statement was released or will be released in 2018
will be scraped from the FED's website.  Statements released before 2011 have 
been archived, whereas statements released since 2012 have not yet been archived 
and are available in a different location of the FED's website.  Therefore, the 
web scraping techniques used to scrape the date of each statement will differ 
based on its website location. Please refer to the `FOMC Policy Statements.R`
file for this code.

## 2.3 Target Federal Funds Rate

Changes to the target federal funds rate are implemented the day 
after the FOMC policy statement is released (Board of Governors of the 
Federal Reserve System).  Therefore, the target rate/range data on the day
after each meeting will be used which represents the outcome of the meeting
by which the market should react to upon the FOMC policy statement release
on day two (the conclusion) of the meeting.

The daily target federal funds rate data are only available from September 27, 1982
to December 15, 2008, while the upper and lower limits of the target federal funds 
rate data are available from December 16, 2008 to present. Therefore, both sets
of data will be pulled from FRED using a FRED API key.  Please refer to the
`Target Rates.R` file for this code.  Once the data are obtained,
the difference between the current rate/limits and previous rate/limits will be
calculated i.e., the target rate/limits on the day after the conclusion of the
FOMC meeting will be subtracted from that of the previous meeting.  Changes in
the target federal funds rate will be compared to changes in volatility and
treasury yields.  Please refer to the `VIX_treasury_fedfunds_meetings_diff.R`
file for this code.

The Research Division of the Federal Reserve Bank of Saint Louis developed 
FRED.  [FRED](https://research.stlouisfed.org/about.html) is a database that 
offers regional and national financial and economic data and information to 
enhance economic research.  FRED is constantly updated and accessible at all times.
The FRED API allows users to retrieve economic data from FRED.  API requests can be 
tailored to retrieve data source, release, category, series, and more. 
[The FRED API documentation is available on FRED's website.](https://research.stlouisfed.org/docs/api)

## 2.4 Volatility 

Changes to the target federal funds rate/limits will be compared to changes in 
volatility (adjusted close minus open price`*` on the day the FOMC policy statement is released) 
to analyze the market's reaction to the FOMC's announcement made in the FOMC 
policy statement.  This look-back analysis will explore whether a relationship
exists between FOMC announcements about the target federal funds rate and volatility.
Please refer to the `VIX_treasury_fedfunds_meetings_diff.R` file for this code.

`*` Intraday data are not available free of charge, therefore, open and close 
data must be used instead.  The assumption is that the open price reflects
market conditions before the FOMC announcement whereas the close price
reflects market conditions as a result of the FOMC announcement.

Daily volatility data will be represented by the Chicago Board Options Exchange
Volatility Index ("VIX").  These data will be obtained from Yahoo Finance.
Please refer to the `VIX.R` file for this code.

## 2.5 Treasury Bills

Daily 10-year treasury note data will be obtained from Yahoo Finance.
Please refer to the `Treasury.R` file for this code.

Changes (adjusted close minus open price`*` on the day the FOMC policy statement is released) 
in the 10-year treasury yield will be analyzed in relation
to changes in the VIX.  The hypothesis is that when volatility increases, on an 
FOMC meeting day, the quantity demanded for 10-year treasury bills will increase, 
driving price up.  Inversely, when volatility decreases, on FOMC meeting days, the 
quantity demanded for 10-year treasury bills will decrease, driving the price down.
Please refer to the `VIX_treasury_fedfunds_meetings_diff.R` file for this code.

`*` Intraday data are not available, therefore, open and close 
data must be used instead.  The assumption is that the open price reflects
market conditions before the FOMC announcement whereas the close price
reflects market conditions as a result of the FOMC announcement.

# 3 R Script and Package Methodology 

The following chronological steps include the R code used create my R package.

1) Create package called `EconFiData`.  This package allows users to gather
economic and financial data from the Federal Reserve and Yahoo Finance.

```{r}
library(roxygen2)
library(devtools)
library(testthat)

path <- "/Users/StephanieLangeland/Desktop/Columbia/Modern Data Structures/Langeland_Stephanie/final project/EconFiData"
```

```{r, eval = FALSE}
devtools::create(path)
```

```{r}
setwd(path)
```

2) Refer to the `/final project/EconFiData/R` folder for the function files
and data files:

```{r, eval = FALSE}
devtools::use_data(meeting_dates)
devtools::use_data(Federal_Funds_Target_Rate)
devtools::use_data(vix_data)
```

3) Set up package dependencies:

```{r, eval = FALSE}
usethis::use_package("httr")
usethis::use_package("rvest")
usethis::use_package("jsonlite")
usethis::use_package("RSelenium")
usethis::use_package("XML")
```

4) Add a `README` file, which includes information about all files within
the package folder:

```{r, eval = FALSE}
devtools::use_readme_rmd()
```

5) Write vignettes:

```{r, eval = FALSE}
devtools::use_vignette("get_historical_dates_vignette")
devtools::use_vignette("get_series_obs_vignette")
devtools::use_vignette("all_yf_functions_vignette")
```

6) Check package: 

```{r}
setwd(path)

library(EconFiData)

check()
```

```{r, eval = FALSE}
usethis::use_testthat()
```

7) Install:

```{r, eval = FALSE}
setwd("..")
install("EconFiData")
```

__Note:__ Example data sets are provided within the package.  Users can download
them and use `rbind()` to add their data to the existing data sets. 

# 4 Summary Statistics

The final data set includes the following variables:

```{r, message = FALSE, warning = FALSE, echo = FALSE, results ='hide'}
final_data <- readRDS("/Users/StephanieLangeland/Desktop/Columbia/Modern Data Structures/Langeland_Stephanie/final project/VIX_treasury_fedfunds_meetings_diff.rds")

shift <- function(x, n) {
  c(x[-(seq(n))], rep(NA, n))
}

final_data$target_rate_change_shift <- shift(final_data$target_rate_change, 1)

View(final_data[ , c(1:3, 21, 24)])

###summary tables:
library(dplyr)

final_data$target_rate_change_shift_sign <- ifelse(
  final_data$target_rate_change_shift < 0,
  "Negative Rate Change",
  final_data$target_rate_change_shift
)

final_data$target_rate_change_shift_sign <- ifelse(
  final_data$target_rate_change_shift > 0,
  "Positive Rate Change",
  final_data$target_rate_change_shift_sign
)

final_data$target_rate_change_shift_sign <- ifelse(
  final_data$target_rate_change_shift == 0,
  "No Rate Change",
  final_data$target_rate_change_shift_sign
)



##:::::::: Variable descriptions/codebook:
date_desc <- "Date of each observation."

fomc_day_1_desc <- "Day one of an FOMC meeting."

fomc_day_2_desc <- "Day two (the conclusion) of an FOMC meeting."

day_after_desc <- "The day after day two (the conclusion) of an FOMC meeting."

vix_open_desc <- "Daily open value of the VIX."

vix_high_desc <- "Daily highest value of the VIX."

vix_low_desc <- "Daily lowest value of the VIX."

vix_close_desc <- "Daily close value of the VIX."

vix_cladj_desc <- "Daily adjusted close value of the VIX."

tbill_open_desc <- "Daily open value of the 10-year treasury note."

tbill_high_desc <- "Daily highest value of the 10-year treasury note."

tbill_low_desc <- "Daily lowest value of the 10-year treasury note."

tbill_close_desc <- "Daily close value of the 10-year treasury note."

tbill_cladj_desc <- "Daily adjusted close value of the 10-year treasury note."

lowlim_desc <- "Daily lower limit value of the target federal funds rate."

uplim_desc <- "Daily upper limit value of the target federal funds rate."

ffr_desc <- "Daily value of the target federal funds rate."

lowlim_diff_desc <- "The lower limit value of the target federal funds rate on the day after the conclusion of the FOMC meeting, subtracted from that of the previous meeting."

uplim_diff_desc <- "The upper limit value of the target federal funds rate on the day after the conclusion of the FOMC meeting, subtracted from that of the previous meeting."

ffr_diff_desc <- "The value of the target federal funds rate on the day after the conclusion of the FOMC meeting, subtracted from that of the previous meeting."

target_rate_change_desc <- "Depending on the year, the FOMC either mentioned the actual target federal funds rate or the lower and upper limits of the target rate in the policy statement.  In order to combine these data into one variable, the `Target_Fed_Funds_Upper_Limits_diff` and `Federal_Funds_Target_Rate_diff` variables were combined into this variable.  This was possible because the upper and lower limits are always adjusted in equal increments.  Thus, it was only necessary to use the upper limit.  Also, the `Federal_Funds_Target_Rate` variable ended on 2008-12-15 while the `Target_Fed_Funds_Lower_Limits` and `Target_Fed_Funds_Upper_Limits` began on 2008-12-16 so there is no overlap."

vix_diff_desc <- "The VIX adjusted close value minus the open value."

tbill_diff_desc <- "The 10-year treasury note adjusted close value minus the open value."

shift_desc <- "Changes to the target federal funds rates/limits are made the day after the conclusion of the FOMC meeting.  Therefore, these observations are always one row below the row containing data from day two of the FOMC meeting because these dates differ.  However, the future path of the target rate is announced at the conclusion of the FOMC meeting on day two, thus that is the day that the market will react.  Therefore, the observations for the `target_rate_change` variable were shifted up one row so that they would be in the same row as day two of each FOMC meeting.  This variable was created for data visualization purposes."

shift_sign_dsc <- "This is the sign of the `target_rate_change` variable.  This variable was created for data visualization purposes."

colnames(final_data)

codebook <- as.data.frame(
  matrix(
    c(
      colnames(final_data),
      date_desc,
      fomc_day_1_desc,
      fomc_day_2_desc,
      day_after_desc,
      vix_open_desc,
      vix_high_desc,
      vix_low_desc,
      vix_close_desc,
      vix_cladj_desc,
      tbill_open_desc,
      tbill_high_desc,
      tbill_low_desc,
      tbill_close_desc,
      tbill_cladj_desc,
      lowlim_desc,
      uplim_desc,
      ffr_desc,
      lowlim_diff_desc,
      uplim_diff_desc,
      ffr_diff_desc,
      target_rate_change_desc,
      vix_diff_desc,
      tbill_diff_desc,
      shift_desc,
      shift_sign_dsc
    ),
    ncol = 2, 
    nrow = 25,
    byrow = FALSE
  )
)
```

```{r, message = FALSE, warning = FALSE, echo = FALSE}
library(knitr)

kable(
  codebook,
  col.names = c("Variable Name", "Variable Description")
)
```

The following is an __interactive chart__ that displays a subset of the final data set
to contextualize the above description of the variables:

```{r, message = FALSE, warning = FALSE, echo = FALSE}
library(DT)

final_data2 <- round(final_data[ , c(5:20, 22:24)],
                     digits = 2)

final_data3 <- cbind(
  final_data[8298:8324, c(1:4, 21, 25)],
  final_data2[8298:8324, ]
)

final_data4 <- final_data3[ , c(
  "Date",
  "fomc_day_1",
  "fomc_day_2",
  "day_after_fomc_day_2",
  "vix_open",
  "vix_high",
  "vix_low",
  "vix_close",
  "vix_adjclose",
  "10_yr_treasury_open",
  "10_yr_treasury_high",
  "10_yr_treasury_low",
  "10_yr_treasury_close",
  "10_yr_treasury_adjclose",
  "Target_Fed_Funds_Lower_Limits",
  "Target_Fed_Funds_Upper_Limits",
  "Federal_Funds_Target_Rate",
  "Target_Fed_Funds_Lower_Limits_diff",
  "Target_Fed_Funds_Upper_Limits_diff",
  "Federal_Funds_Target_Rate_diff",
  "target_rate_change",
  "vix_diff",
  "10_yr_treasury_diff",
  "target_rate_change_shift",
  "target_rate_change_shift_sign" 
)]

datatable(
  final_data4,
  rownames = FALSE
)
```

## 4.1 Target Federal Funds Rate

In order to understand the movements of the VIX and 10-year treasury note, as
a reaction to the target federal funds rate change announced via the FOMC
policy statement, it is important to understand the distribution of the
changes made to the target rate.  From 1995 - 2017, there were
216 FOMC meetings.  The most common rate decision was to leave the target rate
unchanged.  Whereas there is nearly an even split between increasing and decreasing
the rate.  The target federal funds rate is not volatile because the FED
is committed to keeping it stable, which fosters economic stability.
Typically, the FED makes changes to the rate as a response to an economic crisis.
Therefore, many of the rate changes noted below may have been responses to
the saving and loans, dot com, and housing market bubbles that burst during
the study period.

```{r, message = FALSE, warning = FALSE, results = 'hide', echo = FALSE}
library(QMSS)

sign_table <- as.data.frame(
  Tab(
    final_data$target_rate_change_shift_sign
    )
)

sign_table[4, ] <- colSums(sign_table)
rownames(sign_table)[4] <- "Total"
```

```{r, message = FALSE, warning = FALSE, echo = FALSE}
kable(
  sign_table,
  caption = "Summary of Target Federal Funds Rate Changes"
)
```

## 4.2 Volatility

Working on the premise that the FED usually changes the target rate as a reaction to a
crisis or bubble and normalization thereafter, there should still be a market
reaction via volatility.  When the FED decreases the target rate, this signals
accommodative monetary policy, which means that the economy is under stress.
Inversely, when the FED increases the rate, the economy should be in a recovery
or stable period.  However, the rate typically remains flat, per the above table.
Since the 2008 Financial Crisis, the FED lowered rates to the zero lower bound
and has begun tightening in recent years.  Tightening of monetary policy is
analogous to increasing the federal funds rate.  Though, this is a very gradual process
since the FED cannot risk overheating the economy during booms.  The following visualization
is an __interactive__ graph that shows the relationship between the daily change
in the VIX (`vix_diff`) and target federal funds rate (`target_rate_change`)
decision on day two of the FOMC meeting.  Please hover over the VIX values
in order to see the date, amount by which the VIX changed, volatility level, 
and target federal funds rate decision/change.

```{r, message = FALSE, warning = FALSE, echo = FALSE}
library(dplyr)

final_sub <- final_data %>%
  filter(fomc_day_1 == "fomc_day_1" |
           fomc_day_2 == "fomc_meeting_day_2") 


final_sub$fomc_day_1 <- ifelse(
  final_sub$fomc_day_1 == "fomc_meeting_day_1",
  final_sub$Date,
  fomc_meeting_day_1
)

final_sub$fomc_day_1 <- as.Date(final_sub$fomc_day_1)



final_sub$fomc_day_2 <- ifelse(
  final_sub$fomc_day_2 == "fomc_meeting_day_2",
  final_sub$Date,
  fomc_meeting_day_2
)

final_sub$fomc_day_2 <- as.Date(final_sub$fomc_day_2)


final_sub$vix_diff_sign <- ifelse(
  final_sub$vix_diff > 0,
  "Elevated Volatiltiy",
  final_sub$vix_diff
)


final_sub$vix_diff_sign <- ifelse(
  final_sub$vix_diff == 0,
  "Neutral Volatility",
  final_sub$vix_diff_sign
)

final_sub$vix_diff_sign <- ifelse(
  final_sub$vix_diff < 0,
  "Subdued Volatility",
  final_sub$vix_diff_sign
)


View(final_sub)

library(ggplot2)
```

```{r, message = FALSE, warning = FALSE, echo = FALSE, fig.height = 5, fig.width = 20}
chart1 <- final_sub %>%
  ggplot() +
  geom_point(mapping = aes(x = Date,
                           y = target_rate_change_shift * 10,
                           color = target_rate_change_shift_sign),
             shape = 20) +
  geom_line(mapping = aes(x = Date,
                          y = target_rate_change_shift * 10)) +
  geom_point(mapping = aes(x = Date, 
                           y = vix_diff,
                           color = vix_diff_sign,
                           text = paste("Date: ", Date, "\n", 
                                        "VIX Change: ", 
                                        round(vix_diff, digits = 2), "\n",
                                        "Volatility Level: ", vix_diff_sign, "\n",
                                        "Target Federal Funds Rate Change: ", 
                                        target_rate_change_shift)),
             shape = 18) 

chart2 <- chart1 %+%
  scale_y_continuous(name = "VIX Change",
                     sec.axis = sec_axis(~ . / 10,
                                         name = "Target Federal Funds Rate Change"),
                     limits = c(-7,
                                10)) 

chart3 <- chart2 %+%
  ggtitle("Daily Change in the VIX & Target Federal Funds Rate Decision on Day Two of the FOMC Meeting") +
  scale_color_manual(
    name = "                                  Legend",
    labels = c(
    "Elevated Volatiltiy",
    "Negative Rate Change",
    "Neutral Volatility",
    "No Rate Change",
    "Positive Rate Change",
    "Subdued Volatility"),
    values = c(
      "red2",
      "orangered",
      "tan2",
      "yellow2",
      "green3",
      "chartreuse4"
    )) 

#chart3

library(plotly)

Y2 <- list(
  overlaying = "y",
  side = "right",
  title = "Target Federal Funds Rate Change",
  range = c(-0.75, 1.04)
)

legend_details <- list(
  x = 1.09,
  y = 1
)

font_details <- list(
  family = "times new roman",
  size = 12,
  color = 'black')

ggplotly(chart3,
         tooltip = c("text")
         ) %>%
  layout(yaxis2 = Y2,
         legend = legend_details,
         margin = list(r = 150),
         font = font_details) 
```

There does not seem to be a clear pattern between the VIX and target rate.
This may be attributed to exogenous factors that are not accounted for here.
The next step would be to run a regression analysis to understand how well
the changes to the target rate contribute to changes in the VIX.  This
regression analysis is a recommendation for future research as it is
out of scope for this project.

## 4.3 Treasury Bills

The following visualization is an __interactive__ graph that shows the relationship
between the daily change in the 10-year treasury note (`10_yr_treasury_diff`) and 
target federal funds rate (`target_rate_change`) decision on day two of the FOMC
meeting.  Please hover over the 10-year treasury note values in order to see the
date, amount by which the 10-year treasury yield changed, and target federal funds
rate decision/change.

```{r, message = FALSE, warning = FALSE, echo = FALSE}
final_sub$tbill_sign <- ifelse(
  final_sub$`10_yr_treasury_diff` > 0,
  "Treasury Yield Increase",
  final_sub$`10_yr_treasury_diff`
)


final_sub$tbill_sign <- ifelse(
  final_sub$tbill_sign == 0,
  "Neutral Treausry Yield",
  final_sub$tbill_sign
)

final_sub$tbill_sign <- ifelse(
  final_sub$tbill_sign < 0,
  "Treasury Yield Decrease",
  final_sub$tbill_sign
)
```

```{r, message = FALSE, warning = FALSE, echo = FALSE, fig.height = 5, fig.width = 20}
chart4 <- final_sub %>%
  ggplot() +
  geom_point(mapping = aes(x = Date,
                           y = target_rate_change_shift ,
                           color = target_rate_change_shift_sign),
             shape = 20) +
  geom_line(mapping = aes(x = Date,
                          y = target_rate_change_shift  )) +
  geom_point(mapping = aes(x = Date, 
                           y = `10_yr_treasury_diff`,
                           color = tbill_sign,
                           text = paste("Date: ", Date, "\n", 
                                        "10-year Treasury Yield Change: ", 
                                        round(`10_yr_treasury_diff`, digits = 2), "\n",
                                        "Yield: ", tbill_sign, "\n",
                                        "Target Federal Funds Rate Change: ", 
                                        target_rate_change_shift)),
             shape = 15) 

chart5 <- chart4 %+%
  scale_y_continuous(name = "10-year Treasury Yield Change",
                     sec.axis = sec_axis(~ . 
                                         ,
                                         name = "Target Federal Funds Rate Change"),
                     limits = c(-0.4,
                                0.4)) 

chart6 <- chart5 +
  ggtitle("Daily Change in the 10-year Treasury Yield & Target Federal Funds Rate Decision on Day Two of the FOMC Meeting") +
  scale_color_manual(
    name = "                                  Legend",
    labels = c(
    "Negative Rate Change",
    "Neutral Treasury Yield",
    "No Rate Change",
    "Positive Rate Change",
    "Treasury Yield Decrease",
    "Treasury Yield Increase"),
    values = c(
      "orangered",
      "darkgoldenrod2",
      "yellow2",
      "green3",
      "red4",
      "darkgreen"
    ))

#chart6

library(plotly)

Y2 <- list(
  overlaying = "y",
  side = "right",
  title = "Target Federal Funds Rate Change",
  range = c(-0.75, 0.75)
)

legend_details <- list(
  x = 1.09,
  y = 1
)


ggplotly(chart6,
         tooltip = c("text")
         ) %>%
  layout(yaxis2 = Y2,
         legend = legend_details,
         margin = list(r = 150),
         font = font_details) 
```

According to the flight to quality theory, in times of economic uncertainty or stress,
investors typically buy safe haven assets, such as U.S. treasury notes whereas
they tend to buy riskier assets during growth periods.  This theory supports
the demand curve for U.S. treasury notes.  However, the FED can only influence
the supply curve for treasury notes through open market operations, which 
puts upward or downward pressure on interest rates.  The above graph captures
the relationship between the treasury yield and changes in the target rate.  However,
we cannot discern whether movements in the treasury yield were due to movements
in the supply or demand for treasury notes.  Similar to the VIX versus target rate,
there is no clear relationship between the target rate and treasury
yield.  However, the VIX may shed more light on the treasury yield noted above
if the flight to quality theory holds true.  Therefore, the hypothesis supporting
the following __interactive graph__ is that when volatility increases, on day two
of an FOMC meeting day, investors will purchase treasury notes as safe haven assets,
which drives the treasury yield down and the price up.  The reverse should be true
when volatility decreases.  Please hover over the VIX values below in order to see
the date, amount by which the VIX changed, volatility level, amount by which the
10-year treasury yield changed, and target federal funds rate decision/change.

```{r, message = FALSE, warning = FALSE, echo = FALSE, fig.height = 5, fig.width = 20}
 chart7 <- final_sub %>%
  ggplot() +
  geom_point(mapping = aes(x = Date,
                           y = `10_yr_treasury_diff` * 10,
                           color = tbill_sign),
             shape = 15) +
  geom_line(mapping = aes(x = Date,
                          y = `10_yr_treasury_diff` * 10)) +
  geom_point(mapping = aes(x = Date, 
                           y = vix_diff,
                           color = vix_diff_sign,
                           text = paste("Date: ", Date, "\n", 
                                        "VIX Change: ", 
                                        round(vix_diff, digits = 2), "\n",
                                        "Volatility Level: ", vix_diff_sign, "\n",
                                        "10-year Treasury Yield Change: ", 
                                        round(`10_yr_treasury_diff`, digits = 2), "\n",
                                        "Yield: ", tbill_sign, "\n")),
             shape = 18)

chart8 <- chart7 %+%
  scale_y_continuous(name = "VIX Change",
                     sec.axis = sec_axis(~ . / 10,
                                         name = "10-year Treasury Yield Change"),
                     limits = c(-7,
                                10)) 

chart9 <- chart8 +
  ggtitle("Daily Change in the VIX & 10-year Treausry Yield on Day Two of the FOMC Meeting") +
  scale_color_manual(
    name = "                                  Legend",
    labels = c(
    "Elevated Volatiltiy",
    "Neutral Treasury Yield",
    "Neutral Volatility",
    "Subdued Volatility",
    "Treasury Yield Decrease",
    "Treasury Yield Increase"),
    values = c(
      "red2",
      "darkgoldenrod2",
      "tan2",
      "chartreuse4",
      "red4",
      "darkgreen"
    )) 

#chart9

library(plotly)

Y2 <- list(
  overlaying = "y",
  side = "right",
  title = "10-year Treasury Note Change",
  range = c(-0.75, 1.04)
)

legend_details <- list(
  x = 1.09,
  y = 1
)


ggplotly(chart9,
         tooltip = c("text")
         ) %>%
  layout(yaxis2 = Y2,
         legend = legend_details,
         margin = list(r = 150),
         font = font_details) 
```

The above graph does not always display the expected outcome predicated by the
flight to quality theory.  Decreases in the treasury yield are not always accompanied
by increases in the VIX, which would theoretically result from economic stress.
The inverse is also true such that increases in the treasury yield are not
always coupled with subdued volatility, which would hypothetically result
from economic booms.  Therefore, there may be exogenous factors influencing
these relationships that are not accounted for above. 

# 5 Conclusion & Future Research 

The purpose of this research project was to build an R package and write code that
clearly outlines how to obtain economic and financial data from various sources through
API calls and web scraping techniques.  The data obtained from these methods
was then summarized above.  The above graphs display the relationships between
the VIX and target federal funds rate as well as the treasury yield and target 
federal funds rate. These graphs do not present clear patterns between these
variables, which may be caused by non-linear relationships between the variables.
Future researchers may consider conducting a deeper analysis about these relationships
by building various regression models that utilize the above variables as well as other
variables that may account for exogenous shocks to the models.

# 6 Works Cited

Board of Governors of the Federal Reserve System. FOMC's target federal funds 
rate or range, change (basis points) and level. 14 June 2017. 22 November 2017
<https://www.federalreserve.gov/monetarypolicy/openmarket.htm>.

Federal Reserve Bank of Dallas. A Short History of FOMC Communication Vol. 8, 
No. 8, September 2013 . 19 November 2017 
<https://www.dallasfed.org/research/eclett/2013/el1308.cfm>.
	
Federal Reserve Bank of Saint Louis. How Monetary Policy Works. 19 November 
2017 <https://www.stlouisfed.org/in-plain-english/how-monetary-policy-works>.
